<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Zona Privada - Gu√≠a T√©cnica Pericial</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    /* Zona Privada + Navbar fija con pesta√±as */
    body {
      background-color: #f8f8f3;
      background-image: url('images/fondo-patron.png');
      background-repeat: repeat;
      background-size: auto;
      font-family: 'Open Sans', sans-serif;
      padding-top: 90px; /* espacio para la navbar fija */
    }
    .container { max-width: 700px; margin: 0 auto; text-align: center; }
    h1 { color: #6e6651; margin-bottom: 20px; }
    .card { border: 1px solid #9DA588; margin-top: 30px; }
    .card-header { background-color: #9DA588; color: white; font-weight: 600; }
    .btn-paypal { background-color: #ffc439; color: black; font-weight: bold; border: none; }
    .btn-paypal:hover { background-color: #ffb300; }
    .btn-custom { background-color: #9DA588; color: white; border: none; }
    .btn-custom:hover { background-color: #6e6651; }
    .top-actions { display: flex; justify-content: space-between; margin-bottom: 20px; }
    .text-start small { color: #6c757d; }
    .nav-link.active { background-color: #9DA588 !important; color: #fff !important; border-radius: .25rem; }
  </style>
</head>

<body>
  <script>
    const usuario = JSON.parse(localStorage.getItem('usuarioAutenticado'));
    if (!usuario) { window.location.href = 'login.html'; } // Redirige si no hay sesi√≥n
  </script>

  <!-- Navbar fija con pesta√±as -->
  <nav class="navbar navbar-expand-lg bg-light border-bottom fixed-top">
    <div class="container">
      <a class="navbar-brand" href="index.html">Gu√≠a T√©cnica Pericial</a>
      <div class="navbar-nav ms-auto">
        <a class="nav-link active" aria-current="page" href="zona-privada.html">Zona privada</a>
        <a class="nav-link" href="instrucciones.html">Instrucciones</a>
      </div>
    </div>
  </nav>

  <div class="container">
    <div class="top-actions">
      <a href="index.html" class="btn btn-outline-secondary btn-sm">Volver al inicio</a>
      <button class="btn btn-custom btn-sm" onclick="cerrarSesion()">Cerrar Sesi√≥n</button>
    </div>

    <h1>Zona Privada</h1>
    <p id="bienvenida">Bienvenido/a</p>
    <p>Aqu√≠ puedes adquirir tu gu√≠a o realizar una consulta personalizada.</p>

    <!-- Bloque de instrucciones generales -->
    <div class="alert alert-warning mt-4 text-start" role="alert">
      <p class="mb-2"><strong>üí≥ Instrucciones de pago</strong></p>
      <p class="mb-2">
        Realiza el pago directamente en la cuenta de PayPal:<br>
        <strong>üìß paypal: rafacambara@yahoo.es</strong>
      </p>
      <p class="mb-0">
        En el concepto del pago indica:<br>
        ‚Äì <strong>"pago por gu√≠a t√©cnica pericial"</strong> (si compras la gu√≠a)<br>
        ‚Äì <strong>"pago por asesoramiento"</strong> (si contratas la consulta)
      </p>
    </div>

    <!-- Gu√≠a T√©cnica -->
    <div class="card">
      <div class="card-header">Comprar Gu√≠a T√©cnica (110 ‚Ç¨)</div>
      <div class="card-body">
        <p>Realiza el pago de <strong>110 ‚Ç¨</strong> directamente en la cuenta PayPal indicada arriba.</p>
        <a href="https://www.paypal.com/paypalme/rafaelcambaraabad/110" class="btn btn-paypal" target="_blank" rel="noopener">Ir a PayPal</a>
        <p class="mt-3 text-muted">
          ‚ÑπÔ∏è Tras completar el pago, env√≠a el comprobante en
          <strong>el formulario del final de la p√°gina</strong> para verificar tu compra.
        </p>
      </div>
    </div>

    <!-- Consulta personalizada (precio fijo para pago directo) -->
    <div class="card">
      <div class="card-header">Consulta Personalizada (30 ‚Ç¨)</div>
      <div class="card-body">
        <p>Realiza el pago de <strong>30 ‚Ç¨</strong> directamente en la cuenta PayPal indicada arriba.</p>
        <a href="https://www.paypal.com/paypalme/rafaelcambaraabad" class="btn btn-paypal" target="_blank" rel="noopener">Ir a PayPal</a>
        <p class="mt-3 text-muted">
          ‚ÑπÔ∏è Tras completar el pago, env√≠a el comprobante en
          <strong>el formulario del final de la p√°gina</strong> para verificar tu compra. 
        </p>
      </div>
    </div>

    <!-- Consulta gratuita (texto corto) -->
    <div class="card mt-4">
      <div class="card-header">Consulta gratuita (texto corto)</div>
      <div class="card-body">
        <form action="http://localhost:3001/consultas/gratis" method="POST">
          <div class="mb-3 text-start">
            <label class="form-label">Nombre completo</label>
            <input type="text" name="nombre" class="form-control" required>
          </div>
          <div class="mb-3 text-start">
            <label class="form-label">Correo electr√≥nico</label>
            <input type="email" name="correo" class="form-control" required>
          </div>
          <div class="mb-3 text-start">
            <label class="form-label">Asunto (opcional)</label>
            <input type="text" name="asunto" class="form-control">
          </div>
          <div class="mb-3 text-start">
            <label class="form-label">Tu consulta (m√°x. 500 caracteres)</label>
            <textarea name="mensaje" class="form-control" rows="4" maxlength="500" required
              oninput="document.getElementById('contadorGratis').textContent=this.value.length + '/500';"></textarea>
            <small id="contadorGratis">0/500</small>
          </div>
          <button type="submit" class="btn btn-custom">Enviar consulta gratuita</button>
        </form>
        <p class="mt-3 text-muted">
          Recibir√°s un correo de confirmaci√≥n. Responderemos a la mayor brevedad.
        </p>
      </div>
    </div>

    <!-- Consulta extensa (presupuesto personalizado) -->
    <div class="card mt-4">
      <div class="card-header">Consulta personalizada (previo presupuesto)</div>
      <div class="card-body">
        <form action="http://localhost:3001/consultas/presupuesto" method="POST" enctype="multipart/form-data">
          <div class="mb-3 text-start">
            <label class="form-label">Nombre completo</label>
            <input type="text" name="nombre" class="form-control" required>
          </div>
          <div class="mb-3 text-start">
            <label class="form-label">Correo electr√≥nico</label>
            <input type="email" name="correo" class="form-control" required>
          </div>
          <div class="mb-3 text-start">
            <label class="form-label">Asunto (opcional)</label>
            <input type="text" name="asunto" class="form-control">
          </div>
          <div class="mb-3 text-start">
            <label class="form-label">Describe tu consulta</label>
            <textarea name="descripcion" class="form-control" rows="7" required></textarea>
          </div>
          <div class="mb-3 text-start">
            <label class="form-label">Adjuntar archivo (opcional) ‚Äî PDF, imagen o TXT (m√°x. 10MB)</label>
            <input type="file" name="adjunto" class="form-control" accept="application/pdf,image/*,text/plain">
          </div>
          <button type="submit" class="btn btn-custom">Enviar para presupuesto</button>
        </form>
        <p class="mt-3 text-muted">
          Te enviaremos el <b>precio</b> por correo tras revisar tu consulta. El pago se realizar√° en la cuenta PayPal indicada en esta p√°gina.
        </p>
      </div>
    </div>

    <!-- Enviar comprobante de pago por formulario -->
    <div class="card mt-4">
      <div class="card-header">Enviar comprobante de pago</div>
      <div class="card-body">
        <form action="http://localhost:3001/enviar-comprobante" method="POST" enctype="multipart/form-data">
          <div class="mb-3 text-start">
            <label class="form-label">Nombre completo</label>
            <input type="text" name="nombre" class="form-control" required>
          </div>
          <div class="mb-3 text-start">
            <label class="form-label">Correo electr√≥nico</label>
            <input type="email" name="correo" class="form-control" required>
          </div>
          <div class="mb-3 text-start">
            <label class="form-label">Concepto</label>
            <select name="concepto" class="form-control" required>
              <option value="pago por gu√≠a t√©cnica pericial">Pago por gu√≠a t√©cnica pericial</option>
              <option value="pago por asesoramiento">Pago por asesoramiento</option>
            </select>
          </div>
          <div class="mb-3 text-start">
            <label class="form-label">Subir comprobante (PDF o imagen)</label>
            <input type="file" name="comprobante" class="form-control" accept="application/pdf,image/*" required>
          </div>
          <button type="submit" class="btn btn-custom">Enviar comprobante</button>
        </form>
        <p class="mt-3 text-muted">
          ‚ÑπÔ∏è Recibir√°s confirmaci√≥n por email una vez verificado el pago.
        </p>
      </div>
    </div>
  </div>

  <script>
    // Personalizar saludo
    if (usuario) {
      document.getElementById('bienvenida').textContent =
        `Bienvenido/a, ${usuario.nombre} ${usuario.apellido}`;
    }
    function cerrarSesion() {
      localStorage.removeItem('usuarioAutenticado');
      window.location.href = 'login.html';
    }
  </script>
</body>
</html>